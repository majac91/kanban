<div class="task-card">
  <div class="task-header">
    @if (isEditing) {
      <input
        type="text"
        class="task-edit-input"
        [(ngModel)]="editTitle"
        (keyup.enter)="saveEdit()"
        (keyup.escape)="cancelEdit()"
        (blur)="saveEdit()"
        autofocus
      />
    } @else {
      <h3 class="task-title" (click)="startEdit()">
        {{ task()?.title || 'Untitled Task' }}
        <span class="edit-icon">✏️</span>
      </h3>
    }
    <button class="delete-btn" aria-label="Delete task" (click)="deleteTask()">×</button>
  </div>

  <div class="task-footer">
    @if (task()?.loadingPriority) {
      <div class="loading-spinner">
        <span class="spinner"></span>
        <span>Loading priority...</span>
      </div>
    } @else if (task()?.errorPriority) {
      <span class="error-badge">Error</span>
    } @else if (task()?.priority) {
      <span class="priority-badge" [attr.data-priority]="task()?.priority?.toLowerCase()">
        {{ task()?.priority }}
      </span>
    }
  </div>
</div>
